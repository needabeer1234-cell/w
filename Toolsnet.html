<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToolsNet 통신 최적화 가이드</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            color: #e0e0e0;
            line-height: 1.8;
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 50px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }

        h1 {
            color: #64ffda;
            font-size: 2.2em;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 0 0 20px rgba(100, 255, 218, 0.3);
        }

        .language-selector {
            text-align: center;
            margin-bottom: 30px;
        }

        .lang-btn {
            background: rgba(100, 255, 218, 0.2);
            border: 2px solid #64ffda;
            color: #64ffda;
            padding: 10px 20px;
            margin: 0 5px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            font-weight: 600;
        }

        .lang-btn:hover {
            background: rgba(100, 255, 218, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(100, 255, 218, 0.3);
        }

        .lang-btn.active {
            background: #64ffda;
            color: #0f0c29;
        }

        h2 {
            color: #82aaff;
            margin: 40px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(130, 170, 255, 0.3);
            font-size: 1.6em;
        }

        h3 {
            color: #c792ea;
            margin: 25px 0 15px 0;
            font-size: 1.3em;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            overflow: hidden;
        }

        th {
            background: rgba(130, 170, 255, 0.2);
            color: #82aaff;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        tr:hover {
            background: rgba(100, 255, 218, 0.05);
        }

        code {
            background: rgba(100, 255, 218, 0.15);
            color: #64ffda;
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
        }

        strong {
            color: #ffcb6b;
        }

        .warning {
            background: rgba(255, 83, 112, 0.15);
            border-left: 4px solid #ff5370;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        ul {
            margin: 15px 0;
            padding-left: 25px;
        }

        li {
            margin: 10px 0;
        }

        @media (max-width: 768px) {
            .container {
                padding: 30px 20px;
            }
            
            h1 {
                font-size: 1.6em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>HT50으로 ToolsNet/Open Protocol 접속법</h1>
        
        <div class="language-selector">
            <button class="lang-btn active" onclick="changeLanguage('ko')">한국어</button>
            <button class="lang-btn" onclick="changeLanguage('en')">English</button>
            <button class="lang-btn" onclick="changeLanguage('ja')">日本語</button>
        </div>

        <div id="content">

        <h2>1. 포트 설정</h2>
        <table>
            <tr>
                <th>항목</th>
                <th>설정값</th>
                <th>이유</th>
            </tr>
            <tr>
                <td><strong>PIM PORT</strong></td>
                <td><code>6575</code></td>
                <td>PIM/Openprotocol용</td>
            </tr>
            <tr>
                <td><strong>EH2 PORT</strong></td>
                <td><code>6575</code></td>
                <td>경험상 PIM포트와 동일하게</td>
            </tr>
        </table>
        <div class="warning">
            ⚠️ <strong>비표준 포트(6570, 9014) 사용 금지</strong> - 헤더 파싱 오류 및 통신 실패 위험
        </div>

        <h2>2. 기기 식별 설정</h2>
        <table>
            <tr>
                <th>항목</th>
                <th>설정값</th>
                <th>목적</th>
            </tr>
            <tr>
                <td><strong>System Type</strong></td>
                <td><code>42</code> (또는 <code>43</code>)</td>
                <td>42는 Focus61용이지만 경험상 성공확률 높음<br><small>42 실패 시 43 시도</small></td>
            </tr>
            <tr>
                <td><strong>System Number</strong></td>             
                <td><code>90</code> (고유값)</td>
                <td>다른 컨트롤러와 데이터 충돌 방지룰 위해 큰값입력.<br>System Number는 ToolsNet 시스템 내에서 동일한 System Type(장치 유형)에 속한 컨트롤러들 중 해당 기기를 고유하게 식별하기 위해 부여하는 4자리 고유 번호입니다</td>
            </tr>
            <tr>
                <td><strong>Station Number</strong></td>
                <td>90</td>
                <td>다른 컨트롤러와 데이터 충돌 방지룰 위해 큰값입력.<br>ToolsNet 및 오픈 프로토콜 시스템의 논리적 계층 구조에서 특정 작업 위치(스테이션)를 고유하게 식별하기 위해 사용하는 번호입니다.</td>
            </tr>
        </table>
        <div class="warning">
            ⚠️ <strong>System / Station Number 중복 시</strong> 데이터 덮어쓰기 및 리포트 병합 오류 발생
        </div>

        <h2>3. MID 통신 순서</h2>
        <h3>연결 수립 절차</h3>
        <ul>
            <li><strong>MID 0001</strong> - Communication Start (통신 시작점)</li>
            <li><strong>MID 0012</strong> - Application Data Upload Request (설정 동기화)</li>
            <li><strong>MID 0008</strong> - Data Subscription (데이터 구독)</li>
        </ul>

        <h3>세션 유지</h3>
        <ul>
            <li><strong>MID 9999</strong> - Keep-alive (고스트 세션 방지, Error 96 예방)</li>
        </ul>

        <h3>주요 에러 코드</h3>
        <ul>
            <li><strong>Error 16</strong> - Protocol Busy (컨트롤러 부하, 재전송 최적화 필요)</li>
            <li><strong>Error 75</strong> - MID Unsupported (소프트웨어 버전 확인 필요)</li>
            <li><strong>Error 96</strong> - Client Already Connected (Keep-alive로 예방)</li>
        </ul>

        <h2>4. 접속상태 체크리스트</h2>
        <table>
            <tr>
                <th>점검 항목</th>
                <th>설정값</th>
            </tr>
            <tr>
                <td>통신 포트</td>
                <td><code>6575</code></td>
            </tr>
            <tr>
                <td>System Type</td>
                <td><code>42</code> (실패 시 <code>43</code> 시도)</td>
            </tr>
            <tr>
                <td>System / Station Number</td>
                <td>고유값 (예: <code>90</code>)</td>
            </tr>
            <tr>
                <td>Keep-alive</td>
                <td>MID 9999 활성화</td>
            </tr>
            <tr>
                <td>Error 모니터링</td>
                <td>MID 0004 주기적 확인</td>
            </tr>
        </table>
        </div>
    </div>

    <script>
        function changeLanguage(lang) {
            // 버튼 활성화 상태 변경
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // Google Translate 위젯이 로드되어 있는지 확인
            if (typeof google !== 'undefined' && google.translate) {
                const select = document.querySelector('.goog-te-combo');
                if (select) {
                    select.value = lang;
                    select.dispatchEvent(new Event('change'));
                }
            } else {
                // Google Translate 위젯이 없으면 새로 로드
                const script = document.createElement('script');
                script.src = '//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit';
                document.body.appendChild(script);
                
                window.googleTranslateElementInit = function() {
                    new google.translate.TranslateElement({
                        pageLanguage: 'ko',
                        includedLanguages: 'ko,en,ja',
                        layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
                        autoDisplay: false
                    }, 'google_translate_element');
                    
                    // 위젯이 로드된 후 언어 변경
                    setTimeout(() => {
                        const select = document.querySelector('.goog-te-combo');
                        if (select) {
                            select.value = lang;
                            select.dispatchEvent(new Event('change'));
                        }
                    }, 1000);
                };
            }
        }

        // 페이지 로드 시 Google Translate 위젯 초기화
        window.onload = function() {
            const div = document.createElement('div');
            div.id = 'google_translate_element';
            div.style.display = 'none';
            document.body.appendChild(div);
            
            const script = document.createElement('script');
            script.src = '//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit';
            document.body.appendChild(script);
            
            window.googleTranslateElementInit = function() {
                new google.translate.TranslateElement({
                    pageLanguage: 'ko',
                    includedLanguages: 'ko,en,ja',
                    layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
                    autoDisplay: false
                }, 'google_translate_element');
            };
        };
    </script>
</body>
</html>