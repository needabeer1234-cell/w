<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Manual Abstract Viewer</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }

    #login {
      max-width: 300px;
      margin: 120px auto;
      text-align: center;
      border: 1px solid #ccc;
      padding: 20px;
      border-radius: 6px;
    }

    #content {
      display: none;
    }

    input[type="password"],
    input[type="text"] {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
    }

    button {
      padding: 8px 16px;
      cursor: pointer;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 20px;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: left;
    }

    th {
      background: #f2f2f2;
    }
  </style>
</head>

<body>

  <!-- ðŸ” ë¡œê·¸ì¸ -->
  <div id="login">
    <h3>Access Code</h3>
    <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸ ìž…ë ¥" />
    <br><br>
    <button id="loginBtn">Enter</button>
  </div>

  <!-- ðŸ“Š ì½˜í…ì¸  -->
  <div id="content">
    <h2>Manual Abstract</h2>
    <input
      type="text"
      id="filter"
      placeholder="ê²€ìƒ‰ì–´ ìž…ë ¥"
      onkeyup="filterTable()"
    />
    <table id="dataTable"></table>
  </div>

  <!-- âœ… JSëŠ” ë°˜ë“œì‹œ BODY ë§¨ ì•„ëž˜ -->
  <script>
 /***********************
   * ðŸ”´ ë‹ˆê°€ ë°”ê¿€ ë¶€ë¶„ START
   ***********************/
  const API_KEY = "AIzaSyDLbseKzZPdRmMMfzfCtsNgzjREbx7eiEI";
  const SPREADSHEET_ID = "1EovqmVFRMvvOPuDlZF1bR3B9bjl9UYfB-2biHigu1M8";
  const RANGE = "Form Responses 1!A:L";
  const ACCESS_PASSWORD = "1234";
  /***********************
   * ðŸ”´ ë‹ˆê°€ ë°”ê¿€ ë¶€ë¶„ END
   ***********************/

    // ë²„íŠ¼ ì´ë²¤íŠ¸ ì—°ê²°
    document
      .getElementById("loginBtn")
      .addEventListener("click", checkPassword);

    function checkPassword() {
      const input = document.getElementById("password").value;

      if (input === ACCESS_PASSWORD) {
        document.getElementById("login").style.display = "none";
        document.getElementById("content").style.display = "block";
        loadData();
      } else {
        alert("ë¹„ë°€ë²ˆí˜¸ í‹€ë¦¼ ã…‹ã…‹");
      }
    }

    async function loadData() {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${RANGE}?key=${API_KEY}`;

      try {
        const res = await fetch(url);
        const data = await res.json();

        if (!data.values) {
          alert("ì‹œíŠ¸ ë°ì´í„° ì—†ìŒ");
          return;
        }

        renderTable(data.values);
      } catch (e) {
        console.error(e);
        alert("ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨");
      }
    }

    function renderTable(rows) {
      const table = document.getElementById("dataTable");
      table.innerHTML = "";

      rows.forEach((row, idx) => {
        const tr = document.createElement("tr");

        row.forEach(cell => {
          const el = document.createElement(idx === 0 ? "th" : "td");
          el.textContent = cell;
          tr.appendChild(el);
        });

        table.appendChild(tr);
      });
    }

    function filterTable() {
      const keyword = document
        .getElementById("filter")
        .value
        .toLowerCase();

      const rows = document.querySelectorAll("#dataTable tr");

      rows.forEach((row, idx) => {
        if (idx === 0) return;

        row.style.display = row.textContent
          .toLowerCase()
          .includes(keyword)
          ? ""
          : "none";
      });
    }
  </script>

</body>
</html>
