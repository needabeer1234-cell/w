<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ëŒ€ë¦¬ì  ì „ìš© í˜ì´ì§€</title>

<style>
body {
  background:#0f1115;
  color:#e0e0e0;
  font-family:Malgun Gothic,Arial;
  margin:0;
}

.hidden { display:none !important; }

#login-section {
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  background:#0f1115;
}

.login-box {
  background: #161a20;
  padding: 30px;
  border-radius: 10px;
  width: 460px; 
  box-shadow: 0 0 30px rgba(0,0,0,.8);
  text-align: center;

  /* --- ì—¬ê¸°ì„œë¶€í„° ì¶”ê°€ëœ ì„¸ë¡œ ì •ë ¬ ì„¤ì • --- */
  display: flex;           /* í”Œë ‰ìŠ¤ ëª¨ë“œ ì¼œê¸° */
  flex-direction: column;  /* ì•„ë˜ë¡œ í•˜ë‚˜ì”© ìŒ“ê¸° */
  align-items: center;     /* ê°€ë¡œ ì¤‘ì•™ ì •ë ¬ */
  gap: 12px;               /* ìš”ì†Œ ì‚¬ì´ì˜ ê°„ê²© (ì¤„ë°”ê¿ˆ íš¨ê³¼ + ì—¬ë°±) */
}

/* ê³µí†µ ìŠ¤íƒ€ì¼: inputê³¼ buttonì˜ í¬ê¸°ë¥¼ ë˜‘ê°™ì´ ë§ì¶¤ */
input, button {
  width: 300px;        /* ê°€ë¡œ ê¸¸ì´ë¥¼ 300pxë¡œ í†µì¼ */
  height: 45px;        /* ì„¸ë¡œ ë†’ì´ë¥¼ 45pxë¡œ í†µì¼ */
  box-sizing: border-box; /* íŒ¨ë”©ì´ ì¶”ê°€ë˜ì–´ë„ ì „ì²´ í¬ê¸°ê°€ ë³€í•˜ì§€ ì•Šê²Œ ê³ ì • */
  border-radius: 6px;
  font-size: 16px;     /* ê¸€ì í¬ê¸° í†µì¼ */
  text-align: center;
}

input {
  background: #0f1115;
  border: 1px solid #2a2f3a;
  color: #fff;
  padding: 0 12px;     /* ë†’ì´ë¥¼ ê³ ì •í–ˆìœ¼ë¯€ë¡œ ìƒí•˜ íŒ¨ë”©ì€ ë¹¼ê³  ì¢Œìš°ë§Œ */
}

button {
  border: none;
  cursor: pointer;
  display: flex;       /* ê¸€ìë¥¼ ì¤‘ì•™ì— ì™„ë²½íˆ ë§ì¶”ê¸° ìœ„í•´ ì‚¬ìš© */
  align-items: center;
  justify-content: center;
  transition: 0.2s;    /* í˜¸ë²„ ì‹œ ë¶€ë“œëŸ¬ìš´ ë³€í™” íš¨ê³¼ */
}

/* ê° ë²„íŠ¼ë³„ ìƒ‰ìƒë§Œ ë”°ë¡œ ì„¤ì • */
.login-btn { 
  background: #2d6cdf; 
  color: #fff; 
}
.login-btn:hover { background: #2458b8; }

/* ë©”ì¸ í™”ë©´ì˜ ì‹œíŠ¸ ì „í™˜ ë²„íŠ¼ë§Œ ë„ˆë¹„ë¥¼ ìë™ìœ¼ë¡œ ì¡°ì ˆí•˜ê³  ì‹¶ì„ ë•Œ */
.btn-swap {
  width: auto;         /* ê³ ì •ëœ 300pxì„ í•´ì œ */
  min-width: 120px;    /* ìµœì†Œí•œì˜ í¬ê¸° ìœ ì§€ */
  padding: 0 15px;     /* ì¢Œìš° ì—¬ë°± */
  height: 45px;        /* ë†’ì´ëŠ” ë‹¤ë¥¸ ìš”ì†Œì™€ í†µì¼ */
  font-size: 14px;     /* ê¸€ì í¬ê¸° ì‚´ì§ ì¡°ì • */
}

.protect-btn {
  margin-top: 10px;    /* ìœ„ìª½ ê°„ê²© ì‚´ì§ ì¡°ì • */
  background: #0f1115;
  border: 2px solid #ff5252;
  color: #ff5252;
  font-weight: bold;
}
.protect-btn:hover { 
  background: #ff5252; 
  color: #0f1115; 
}

/* ê²€ìƒ‰ì°½ ì „ìš© ì„¤ì • (ì´ì „ì— ìš”ì²­í•˜ì‹  ë…¸ë€ ë°°ê²½ ìœ ì§€) */
#searchInput {
  background: #ffeb3b;
  color: #000;
  border: 1px solid #fdd835;
}

#content {
  padding:20px;
}

#top-bar {
  display:flex;
  justify-content:flex-start;
  align-items:center;
  margin-bottom:10px;
}

#sheet-name { font-size:2em; font-weight:bold; }

.table-wrap { overflow-x:auto; }

table {
  border-collapse:collapse;
  width:max-content;
  min-width:100%;
}

th, td {
  padding:8px 12px;
  border-bottom:1px solid #333;
  white-space:nowrap;
}

th {
  background:#202b38;
  position:sticky;
  top:0;
}

td:hover {
  white-space:normal;
  background:#2a3a4a;
}

#search-box {
  display:30ch;
  gap:10px;
  margin:10px 0;
}

#searchInput {
  background: #ffeb3b;  /* ë…¸ë€ìƒ‰ ë°°ê²½ */
  color: #000000;       /* ê²€ì •ìƒ‰ ê¸€ì”¨ */
  border: 1px solid #fdd835; /* í…Œë‘ë¦¬ë„ ë…¸ë‘ ê³„ì—´ë¡œ */
}

/* ë…¸ë€ ë°°ê²½ì´ë¼ í°ìƒ‰ ì•ˆë‚´ë¬¸êµ¬(placeholder)ê°€ ì•ˆ ë³´ì¼ ìˆ˜ ìˆì–´ ì§„í•œ ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
#searchInput::placeholder {
  color: #444;
</style>
</head>

<body>

<!-- ë¡œê·¸ì¸ -->
<div id="login-section">
  <div class="login-box">
    <h2>ì—ìŠ¤í‹± ëŒ€ë¦¬ì  ì „ìš© í˜ì´ì§€</h2>
    <input type="password" id="pass" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥"
           onkeypress="if(event.key==='Enter') login()">
    <button class="login-btn" onclick="login()">ì ‘ì†í•˜ê¸°</button>

    <button id="protectBtn" class="protect-btn"
      onclick="location.href='https://docs.google.com/forms/d/e/1FAIpQLSetZPoILgJ7bKKh4foBkncz_UsZFQTBvX04AMzKoUli0gUXuQ/viewform'">
      ë³´í˜¸ìš”ì²­ì€ ì´ê³³ì„ í´ë¦­
    </button>
  </div>
</div>

<!-- ë©”ì¸ -->
<div id="content" class="hidden">
  
  <div class="control-section">
    <div id="top-bar">
      <button class="btn-swap" onclick="swapSheet()">ğŸ” ì‹œíŠ¸ ê°„ ì „í™˜</button>
      <span id="sheet-name"></span>
    </div>

    <div id="search-box">
      <input type="text" id="searchInput" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥" onkeyup="filterTable()">
    </div>
  </div> <hr class="divider">
  
  <div id="table-container"></div>

</div>

<script>
let currentSheet = 0;
function login() {
  const pw = document.getElementById('pass').value;

  fetch('https://script.google.com/macros/s/ë„ˆì˜_ID/exec', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      action: 'login',
      password: pw
    })
  })
  .then(res => res.json())
  .then(res => {
    if (!res.success) {
      alert('ë¹„ë°€ë²ˆí˜¸ ì˜¤ë¥˜');
      return;
    }

    document.getElementById('login-section').classList.add('hidden');
    document.getElementById('content').classList.remove('hidden');
    document.getElementById('protectBtn').remove();
    loadSheet(0);
  })
  .catch(err => {
    alert('í†µì‹  ì˜¤ë¥˜');
    console.error(err);
  });
}

/* ì‹œíŠ¸ ë¡œë“œ */
function loadSheet(idx) {
  currentSheet = idx;
  document.getElementById('searchInput').value = '';

  google.script.run.withSuccessHandler(res => {
    document.getElementById('sheet-name').innerText = 'ğŸ“„ ' + res.name;
    makeTable(res.data);
  }).getSheetDataByIndex(idx);
}

/* ìŠ¤ì™‘ */
function swapSheet() {
  loadSheet(currentSheet === 0 ? 1 : 0);
}

/* í…Œì´ë¸” */
function makeTable(data) {
  let html = '<div class="table-wrap"><table><tbody>';
  data.forEach(r => {
    html += '<tr>';
    r.forEach(c => html += `<td>${c ?? ''}</td>`);
    html += '</tr>';
  });
  html += '</tbody></table></div>';
  document.getElementById('table-container').innerHTML = html;
}

/* ê²€ìƒ‰ */
function filterTable() {
  const q = document.getElementById('searchInput').value.toLowerCase();
  document.querySelectorAll('#table-container tr').forEach(tr=>{
    tr.style.display = tr.innerText.toLowerCase().includes(q) ? '' : 'none';
  });
}
</script>

</body>
</html>
